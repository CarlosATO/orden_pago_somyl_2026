{# templates/ordenes/form_modern.html #}
{% extends "base.html" %}
{% block title %}Ã“rdenes de Compra - Apps. Adquisiciones{% endblock %}

{% block content %}
<h1 class="titulo-modulo w-100 titulo-modulo-con-icono">
  <span class="icono-modulo">ðŸ“‹</span>
  Ã“rdenes de Compra
</h1>

<style>
  /* Estilos modernos y elegantes */
  .box {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    border: 1px solid rgba(102, 126, 234, 0.08);
    border-radius: 16px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 
      0 8px 30px rgba(0, 0, 0, 0.06),
      0 1px 5px rgba(0, 0, 0, 0.04),
      inset 0 1px 0 rgba(255, 255, 255, 0.6);
    position: relative;
    overflow: hidden;
    animation: fadeInUp 0.5s ease-out;
  }

  .box::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
    opacity: 0.7;
  }

  .box h5 {
    color: var(--primary-color);
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
  }

  /* Formularios modernos */
  .form-control, select.form-control {
    background: rgba(255, 255, 255, 0.9);
    border: 2px solid rgba(226, 232, 240, 0.8);
    border-radius: 8px;
    padding: 0.6rem 0.8rem;
    font-size: 0.9rem;
    height: 42px !important;
    font-weight: 500;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
  }

  .form-control:focus, select.form-control:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    background: white;
    transform: translateY(-1px);
  }

  /* Labels modernos */
  label {
    font-weight: 600;
    font-size: 0.85rem;
    color: var(--text-primary);
    margin-bottom: 0.4rem;
    letter-spacing: 0.3px;
  }

  /* Tabla moderna */
  .line-table {
    font-size: 0.9rem;
    border-collapse: collapse;
    margin-top: 1rem;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    border-radius: 12px;
    overflow: hidden;
  }

  .line-table th, .line-table td {
    border: 1px solid #e2e8f0;
    padding: 0.8rem 0.6rem;
    text-align: center;
    vertical-align: middle;
  }

  .line-table th {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    font-weight: 700;
    font-size: 0.8rem;
    color: var(--text-primary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 2px solid var(--primary-color);
  }

  .line-table tbody tr {
    transition: all 0.2s ease;
  }

  .line-table tbody tr:hover {
    background: rgba(102, 126, 234, 0.03);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  }

  /* Anchos especÃ­ficos para columnas */
  .line-table th:nth-child(1) { width: 45%; } /* DESCRIPCIÃ“N */
  .line-table th:nth-child(2) { width: 15%; } /* CANTIDAD */
  .line-table th:nth-child(3) { width: 17.5%; } /* NETO */
  .line-table th:nth-child(4) { width: 17.5%; } /* TOTAL */
  .line-table th:nth-child(5) { width: 5%; } /* ACCIONES */

  /* Input dentro de la tabla */
  .line-table input[type="text"], .line-table input[type="number"] {
    width: 100%;
    border: 1px solid #ced4da;
    border-radius: 6px;
    padding: 0.4rem;
    text-align: center;
    font-weight: 600;
    background: rgba(255, 255, 255, 0.9);
    transition: all 0.2s ease;
  }

  .line-table input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
  }

  /* DescripciÃ³n alineada a la izquierda */
  .line-table td:nth-child(1) {
    text-align: left;
    font-weight: 500;
  }

  /* BotÃ³n de eliminar fila */
  .btn-delete-row {
    background: #dc3545;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 0.3rem 0.6rem;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .btn-delete-row:hover {
    background: #c82333;
    transform: scale(1.05);
  }

  .btn-delete-row:disabled {
    background: #6c757d;
    cursor: not-allowed;
    transform: none;
  }

  /* Select2 moderno */
  .select2-container--default .select2-selection--single {
    height: 42px !important;
    border-radius: 8px !important;
    padding: 0.6rem 0.8rem !important;
    background: rgba(255, 255, 255, 0.9) !important;
    border: 2px solid rgba(226, 232, 240, 0.8) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04) !important;
    transition: all 0.3s ease !important;
  }

  .select2-container--default .select2-selection--single:focus {
    border-color: var(--primary-color) !important;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1) !important;
  }

  .select2-container--default .select2-selection--single .select2-selection__rendered {
    line-height: 30px !important;
    font-size: 0.9rem !important;
    font-weight: 500 !important;
    padding-left: 0 !important;
    color: var(--text-primary) !important;
  }

  .select2-container--default .select2-selection--single .select2-selection__arrow {
    height: 42px !important;
    top: 0 !important;
    right: 8px !important;
  }

  .select2-dropdown {
    border: 2px solid var(--primary-color) !important;
    border-radius: 8px !important;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15) !important;
    background: white !important;
  }

  /* Botones modernos */
  .btn-custom {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    border: none;
    padding: 0.7rem 1.5rem;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    position: relative;
    overflow: hidden;
  }

  .btn-custom::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.6s ease;
  }

  .btn-custom:hover::before {
    left: 100%;
  }

  .btn-custom:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
    color: white;
  }

  .btn-custom:disabled {
    background: #6c757d;
    box-shadow: none;
    transform: none;
    cursor: not-allowed;
  }

  .btn-secondary-custom {
    background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
    color: white;
    border: none;
    padding: 0.7rem 1.5rem;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
  }

  .btn-secondary-custom:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(108, 117, 125, 0.4);
    color: white;
  }

  /* Checkbox moderno */
  .form-check {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0;
  }

  .form-check-input {
    width: 18px;
    height: 18px;
    border: 2px solid var(--primary-color);
    border-radius: 4px;
    background: white;
    transition: all 0.2s ease;
  }

  .form-check-input:checked {
    background: var(--primary-color);
    border-color: var(--primary-color);
  }

  .form-check-label {
    font-weight: 500;
    color: var(--text-primary);
    margin: 0;
  }

  /* Totales elegantes */
  .totals {
    text-align: right;
    margin-top: 1.5rem;
    padding: 1rem;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
    border-radius: 8px;
    border: 1px solid rgba(102, 126, 234, 0.1);
  }

  .totals p {
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--text-primary);
  }

  /* Observaciones */
  .observaciones-box {
    background: rgba(255, 255, 255, 0.9);
    border: 2px solid rgba(226, 232, 240, 0.8);
    border-radius: 8px;
    padding: 1rem;
    margin-top: 1.5rem;
  }

  .observaciones-box textarea {
    border: none;
    background: transparent;
    resize: vertical;
    min-height: 80px;
  }

  .observaciones-box textarea:focus {
    outline: none;
    box-shadow: none;
  }

  /* Animaciones */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Responsive */
  @media (max-width: 768px) {
    .box {
      padding: 1rem;
      margin-bottom: 1rem;
    }
    
    .line-table {
      font-size: 0.8rem;
    }
    
    .line-table th, .line-table td {
      padding: 0.5rem 0.3rem;
    }
  }
</style>

<form method="POST" action="{{ url_for('ordenes.new_orden') }}" id="ordenForm">
  <!-- ENCABEZADO MODERNO -->
  <div class="box">
    <h5>
      <i class="bi bi-file-earmark-plus"></i>
      Datos de la Orden de Compra
    </h5>
    
    <div class="row mb-3">
      <div class="col-md-2">
        <label for="next_num">NÂ° OC:</label>
        <input type="text" name="next_num" id="next_num" class="form-control" value="{{ next_num }}" readonly>
      </div>
      <div class="col-md-5">
        <label for="proveedor_id">Proveedor:</label>
        <select name="proveedor_id" id="proveedor_id" class="form-control" required>
          <option value="">Seleccione un proveedor...</option>
          {% for proveedor in proveedores %}
          <option value="{{ proveedor.id }}" data-rut="{{ proveedor.rut }}">{{ proveedor.nombre }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-5">
        <label for="rut">RUT:</label>
        <input type="text" id="rut" name="rut" class="form-control" placeholder="RUT del proveedor" readonly>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-md-4">
        <label for="tipo_entrega">Tipo de entrega:</label>
        <select id="tipo_entrega" name="tipo_entrega" class="form-control" required>
          <option value="">â€” Seleccione tipo de entrega â€”</option>
          {% for tipo in tipos_entrega %}
          <option value="{{ tipo }}">{{ tipo }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-4">
        <label for="plazo_pago">Plazo de pago:</label>
        <select id="plazo_pago" name="plazo_pago" class="form-control" required>
          <option value="">â€” Seleccione plazo pago â€”</option>
          {% for plazo in plazos_pago %}
          <option value="{{ plazo }}">{{ plazo }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-4">
        <div class="form-check" style="margin-top: 2rem;">
          <input type="checkbox" id="incluir_iva" name="incluir_iva" class="form-check-input" value="1" checked="checked">
          <label for="incluir_iva" class="form-check-label">
            <strong>âœ“ Incluir IVA (19%)</strong>
          </label>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <label for="proyecto_id">Proyecto:</label>
        <select name="proyecto_id" id="proyecto_id" class="form-control" required>
          <option value="">Seleccione un proyecto...</option>
          {% for proyecto in proyectos %}
          <option value="{{ proyecto.id }}">{{ proyecto.proyecto }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-6">
        <label for="solicitado_por">Solicitado por:</label>
        <select name="solicitado_por" id="solicitado_por" class="form-control" required>
          <option value="">Seleccione un trabajador...</option>
          {% for trabajador in trabajadores %}
          <option value="{{ trabajador.id }}">{{ trabajador.nombre }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
  </div>

  <!-- DETALLE DE PRODUCTOS MODERNO -->
  <div class="box">
    <h5>
      <i class="bi bi-list-ul"></i>
      Detalle de Productos
    </h5>
    
    <div class="table-responsive">
      <table class="table line-table" id="lineTable">
        <thead>
          <tr>
            <th>DESCRIPCIÃ“N</th>
            <th>CANTIDAD</th>
            <th>NETO UNITARIO</th>
            <th>TOTAL</th>
            <th>ACCIONES</th>
          </tr>
        </thead>
        <tbody id="lines">
          <tr>
            <td>
              <select name="desc_linea[]" class="form-control material-descripcion" required></select>
              <input type="hidden" name="cod_linea[]" class="material-codigo">
            </td>
            <td>
              <input type="number" name="cant_linea[]" class="form-control cantidad" min="1" step="1" placeholder="0" required>
            </td>
            <td>
              <input type="text" name="neto_linea[]" class="form-control neto" placeholder="$0" required>
            </td>
            <td>
              <input type="text" name="total_linea[]" class="form-control total" placeholder="$0" readonly>
            </td>
            <td>
              <button type="button" class="btn btn-delete-row" onclick="deleteRow(this)" disabled>
                <i class="bi bi-trash"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <!-- BotÃ³n para agregar lÃ­neas -->
    <div class="d-flex justify-content-between align-items-center mt-3">
      <button type="button" id="addLine" class="btn btn-secondary-custom">
        <i class="bi bi-plus-circle me-2"></i>Agregar LÃ­nea
      </button>
      
      <div class="totals">
        <p><strong>SUMA NETO:</strong> <span id="sumNeto">$0</span></p>
        <p><strong>SUMA IVA:</strong> <span id="sumIva">$0</span></p>
        <p><strong>SUMA TOTAL:</strong> <span id="sumTotal">$0</span></p>
      </div>
    </div>
  </div>

  <!-- OBSERVACIONES MODERNAS -->
  <div class="box observaciones-box">
    <h5>
      <i class="bi bi-chat-text"></i>
      Observaciones
    </h5>
    <textarea name="observaciones" id="observaciones" class="form-control" rows="3" placeholder="Ingrese observaciones adicionales..."></textarea>
  </div>

  <!-- BOTONES DE ACCIÃ“N MODERNOS -->
  <div class="d-flex justify-content-end gap-3 mt-4">
    <button type="button" id="pdf-btn" class="btn btn-secondary-custom">
      <i class="bi bi-file-earmark-pdf me-2"></i>Generar PDF
    </button>
    <button type="submit" id="save-btn" class="btn btn-custom">
      <i class="bi bi-save me-2"></i>Guardar Orden de Compra
    </button>
  </div>
</form>

<!-- Modal de guardando -->
<div class="modal fade" id="modalGuardando" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-center">
      <div class="modal-body">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Guardando...</span>
        </div>
        <p class="mt-3 mb-0">Guardando orden de compra...</p>
      </div>
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<script>
$(document).ready(function() {
  // Inicializar Select2 para todos los campos de selecciÃ³n
  $('#proveedor_id').select2({
    width: '100%',
    placeholder: "Seleccione un proveedor...",
    allowClear: true
  });

  $('#proyecto_id').select2({
    width: '100%',
    placeholder: "Seleccione un proyecto...",
    allowClear: true
  });

  $('#solicitado_por').select2({
    width: '100%',
    placeholder: "Seleccione un trabajador...",
    allowClear: true
  });

  $('#tipo_entrega').select2({
    width: '100%',
    placeholder: "Seleccione tipo de entrega...",
    allowClear: true
  });

  $('#plazo_pago').select2({
    width: '100%',
    placeholder: "Seleccione plazo de pago...",
    allowClear: true
  });

  // Al seleccionar proveedor, actualizar RUT
  $('#proveedor_id').on('change', function() {
    const selectedOption = $(this).find('option:selected');
    const rut = selectedOption.data('rut') || '';
    $('#rut').val(rut);
  });

  // Inicializar Select2 para materiales
  function initMaterialSelect2($row) {
    $row.find('select.material-descripcion').select2({
      width: '100%',
      placeholder: "Buscar material...",
      allowClear: true,
      minimumInputLength: 2,
      ajax: {
        url: "/ordenes/api/materiales",
        dataType: 'json',
        delay: 400,
        data: function (params) { 
          return { term: params.term }; 
        },
        processResults: function (data) { 
          return { results: data.results || [] }; 
        },
        cache: true
      },
      templateResult: function(data) {
        if (data.loading) return data.text;
        
        return $(
          '<div class="select2-result-material">' +
            '<div class="material-name">' + (data.text || '') + '</div>' +
            '<div class="material-details">' +
              '<small class="text-muted">CÃ³digo: ' + (data.codigo || 'N/A') + '</small>' +
            '</div>' +
          '</div>'
        );
      }
    });
  }

  // Inicializar primera fila
  initMaterialSelect2($('#lines tr').first());

  // Agregar nueva lÃ­nea
  $('#addLine').click(function() {
    const $newRow = $('#lines tr:first').clone();
    $newRow.find('select, input').val('').removeAttr('data-select2-id');
    $newRow.find('.select2-container').remove();
    // Habilitar el botÃ³n de eliminar en la nueva fila
    $newRow.find('.btn-delete-row').prop('disabled', false);
    $('#lines').append($newRow);
    initMaterialSelect2($newRow);
    updateDeleteButtons();
  });

  // FunciÃ³n para eliminar fila
  window.deleteRow = function(button) {
    const $row = $(button).closest('tr');
    const totalRows = $('#lines tr').length;
    
    if (totalRows > 1) {
      // Destruir Select2 antes de eliminar
      $row.find('select').select2('destroy');
      $row.remove();
      
      // Recalcular totales despuÃ©s de eliminar
      $('#lines tr').each(function() {
        const inputCant = $(this).find('input[name="cant_linea[]"]');
        if (inputCant.length) recalcular(inputCant[0]);
      });
      
      updateDeleteButtons();
    }
  };

  // FunciÃ³n para actualizar estado de botones de eliminar
  function updateDeleteButtons() {
    const totalRows = $('#lines tr').length;
    $('#lines .btn-delete-row').prop('disabled', totalRows <= 1);
  }

  // Manejar selecciÃ³n de material
  $('#lines').on('select2:select', 'select.material-descripcion', function(e) {
    const $row = $(this).closest('tr');
    const data = e.params.data;
    
    $row.find('input.material-codigo').val(data.codigo || '');
    $row.find('input[name="neto_linea[]"]').val(data.ultimo_precio || 0);
    
    recalcular($row.find('input[name="cant_linea[]"]')[0]);
    
    // Habilitar botÃ³n de eliminar cuando se selecciona un material
    $row.find('.btn-delete-row').prop('disabled', false);
    updateDeleteButtons();
  });

  // FunciÃ³n para recalcular totales
  function recalcular(input) {
    const $row = $(input).closest('tr');
    const cantidad = parseFloat($row.find('input[name="cant_linea[]"]').val()) || 0;
    const neto = parseFloat($row.find('input[name="neto_linea[]"]').val()) || 0;
    const totalLinea = cantidad * neto;

    $row.find('input[name="total_linea[]"]').val(totalLinea ? `$${totalLinea.toLocaleString('es-CL')}` : '$0');

    // Recalcular totales generales
    let sumaNeto = 0;
    $('#lines tr').each(function() {
      const cant = parseFloat($(this).find('input[name="cant_linea[]"]').val()) || 0;
      const net = parseFloat($(this).find('input[name="neto_linea[]"]').val()) || 0;
      sumaNeto += cant * net;
    });

    const sinIva = !$('#incluir_iva').is(':checked');  // Invertido: sin IVA = NO incluir IVA
    const iva = sinIva ? 0 : Math.round(sumaNeto * 0.19);
    const sumaTotal = sumaNeto + iva;

    $('#sumNeto').text(`$${sumaNeto.toLocaleString('es-CL')}`);
    $('#sumIva').text(`$${iva.toLocaleString('es-CL')}`);
    $('#sumTotal').text(`$${sumaTotal.toLocaleString('es-CL')}`);
  }

  // Listeners para recalcular
  $(document).on('input', 'input[name="cant_linea[]"], input[name="neto_linea[]"]', function() {
    recalcular(this);
  });

  $('#incluir_iva').on('change', function() {
    console.log('DEBUG FRONTEND: Checkbox incluir_iva cambiÃ³ a:', $(this).is(':checked'));
    $('#lines tr').each(function() {
      const inputCant = $(this).find('input[name="cant_linea[]"]');
      if (inputCant.length) recalcular(inputCant[0]);
    });
  });

  // Manejar envÃ­o del formulario con advertencia de confirmaciÃ³n
  $('#ordenForm').submit(function(e) {
    if (!confirm('Â¿EstÃ¡s seguro de que quieres grabar la Orden de Compra?')) {
      e.preventDefault();
      return;
    }
    const btnSave = $('#save-btn');
    btnSave.prop('disabled', true);
    btnSave.html('<i class="bi bi-hourglass-split me-2"></i>Guardando...');
    $('#modalGuardando').modal('show');
  });

  // Generar PDF
  $('#pdf-btn').click(function() {
    console.log('DEBUG FRONTEND: BotÃ³n PDF clickeado');
    console.log('DEBUG FRONTEND: Estado del checkbox antes de enviar:', $('#incluir_iva').is(':checked'));
    console.log('DEBUG FRONTEND: Valor del checkbox antes de enviar:', $('#incluir_iva').val());
    
    // Deshabilitar botÃ³n para evitar doble click
    const pdfBtn = $(this);
    pdfBtn.prop('disabled', true);
    pdfBtn.html('<i class="bi bi-hourglass-split me-2"></i>Generando PDF...');
    
    // Crear formulario temporal para envÃ­o
    const form = $('#ordenForm');
    const formData = new FormData(form[0]);
    
    // Realizar request para generar PDF
    fetch('{{ url_for("ordenes.generate_pdf") }}', {
      method: 'POST',
      body: formData
    })
    .then(response => {
      if (response.ok) {
        return response.blob();
      }
      throw new Error('Error en la respuesta del servidor');
    })
    .then(blob => {
      // Crear URL y descargar archivo
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.style.display = 'none';
      a.href = url;
      a.download = `O. Compra ${$('#next_num').val()}.pdf`;
      document.body.appendChild(a);
      a.click();
      window.URL.revokeObjectURL(url);
      
      // Restaurar botÃ³n
      pdfBtn.prop('disabled', false);
      pdfBtn.html('<i class="bi bi-file-earmark-pdf me-2"></i>Generar PDF');
    })
    .catch(error => {
      console.error('Error:', error);
      alert('Error al generar el PDF. Por favor, intenta nuevamente.');
      
      // Restaurar botÃ³n
      pdfBtn.prop('disabled', false);
      pdfBtn.html('<i class="bi bi-file-earmark-pdf me-2"></i>Generar PDF');
    });
  });

  // Inicializar estado de botones de eliminar al cargar
  updateDeleteButtons();
  
  // FORZAR que el checkbox de IVA estÃ© marcado al cargar la pÃ¡gina
  $('#incluir_iva').prop('checked', true);
  console.log('DEBUG: Checkbox IVA forzado a marcado al cargar pÃ¡gina');
});
</script>

{% endblock %}
