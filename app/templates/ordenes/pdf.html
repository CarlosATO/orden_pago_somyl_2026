<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>OC {{ orden_compra }}</title>
  <style>
    @page { margin: 1.5cm; }
    body { font-family: sans-serif; font-size: 12px; color: #333; }
    header { display: flex; justify-content: space-between; margin-bottom: 20px; }
    .emisora { width: 60%; }
    .emisora h2 { margin: 0; font-size: 16px; }
    .emisora p { margin: 2px 0; font-size: 11px; }
    .titulo { text-align: right; }
    .titulo h1 { margin: 0; font-size: 18px; }
    .titulo p { margin: 4px 0; font-size: 11px; }

    .destinatario, .observaciones-block { margin-bottom: 15px; }
    .destinatario p { margin: 1px 0; }
    .table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
    .table th, .table td { border: 1px solid #666; padding: 4px; text-align: center; }
    .table th { background: #eee; }

    .firmas { display: flex; justify-content: flex-end; margin-top: 30px; }
    .firma { text-align: center; width: 200px; }
    .firma .line { border-top: 1px solid #000; margin-top: 40px; }
  </style>
</head>
<body>
  <header>
    <div class="emisora">
      <h2>{{ empresa_nombre }}</h2>
      <p>RUT: {{ empresa_rut }}</p>
      <p>Giro: {{ empresa_giro }}</p>
      <p>Dirección: {{ empresa_dir }}</p>
      <p>Fono: {{ empresa_fono }}</p>
    </div>
    <div class="titulo">
      <h1>ORDEN DE COMPRA</h1>
      <p>N° {{ orden_compra }}</p>
      <p>Fecha: {{ fecha }}</p>
    </div>
  </header>

  <div class="destinatario">
    <p><strong>Señores:</strong> {{ proveedor_nombre }} (RUT: {{ rut_proveedor }})</p>
    <p><strong>Tipo de Entrega:</strong> {{ tipo_entrega }}</p>
    <p><strong>Plazo de Pago:</strong> {{ plazo_pago }}{% if sin_iva %}, Sin IVA{% endif %}</p>
    <p><strong>Proyecto:</strong> {{ proyecto_nombre }}</p>
    <p><strong>Solicitado por:</strong> {{ solicitante }}</p>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>CÓDIGO</th>
        <th>DESCRIPCIÓN</th>
        <th>CANTIDAD</th>
        <th>NETO</th>
        <th>TOTAL</th>
      </tr>
    </thead>
    <tbody>
      {% for ln in lineas %}
      <tr>
        <td>{{ ln.codigo }}</td>
        <td style="text-align:left">{{ ln.descripcion }}</td>
        <td>{{ ln.cantidad }}</td>
        <td style="text-align:right">{{ "{:,.2f}".format(ln.neto) }}</td>
        <td style="text-align:right">{{ "{:,.2f}".format(ln.total) }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% if observaciones %}
  <div class="observaciones-block">
    <p><strong>Observaciones:</strong></p>
    <p style="border:1px solid #666; padding:6px;">{{ observaciones }}</p>
  </div>
  {% endif %}

  <div class="firmas">
    <div class="firma">
      <div class="line"></div>
      <p>Luis Medina</p>
      <p>Aprobación de Gerencia</p>
    </div>
  </div>
</body>
</html>