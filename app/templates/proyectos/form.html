{# templates/proyectos/form.html #}
{% extends "base.html" %}
{% block title %}Proyectos - Apps. Adquisiciones{% endblock %}

{% block content %}
  <style>
    /* Neumorphism y estilos locales */
    #searchInput {
      width:100%; background:#fafafa; border:none; border-radius:.75rem;
      padding:.5rem .75rem; box-shadow:inset 4px 4px 8px rgba(0,0,0,0.05), inset -4px -4px 8px rgba(255,255,255,0.7);
      margin-bottom:1.5rem; font-size:.9rem; transition:box-shadow .2s;
    }
    #searchInput:focus { outline:none; box-shadow:inset 2px 2px 4px rgba(0,0,0,0.05), inset -2px -2px 4px rgba(255,255,255,0.7); }
    .form-control { background:#fafafa; border:none; border-radius:.75rem; padding:.5rem .75rem; box-shadow:inset 4px 4px 8px rgba(0,0,0,0.05), inset -4px -4px 8px rgba(255,255,255,0.7); margin-bottom:.75rem; transition:box-shadow .2s; }
    .form-control:focus { outline:none; box-shadow:inset 2px 2px 4px rgba(0,0,0,0.05), inset -2px -2px 4px rgba(255,255,255,0.7); }
    .btn-custom, .btn-primary, .btn-warning, .btn-secondary { border:none; border-radius:1rem; padding:.5rem 1rem; box-shadow:4px 4px 8px rgba(0,0,0,0.1),-4px -4px 8px rgba(255,255,255,0.7); transition:transform .2s,box-shadow .2s; }
    .btn-custom:hover, .btn-primary:hover, .btn-warning:hover, .btn-secondary:hover { transform:translateY(-2px); box-shadow:6px 6px 12px rgba(0,0,0,0.12),-6px -6px 12px rgba(255,255,255,0.75); }
    .line-separator { border:none; border-top:1px solid rgba(0,0,0,0.1); margin-bottom:1rem; }
    .table { border-radius:.75rem; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.05); margin-top:1.5rem; font-size:.9rem; }
    .table th, .table td { text-align:center; vertical-align:middle; padding:.75rem; }
    .table thead { background:rgba(0,0,0,0.03); font-weight:600; }
    .alert { border-radius:.75rem; margin-bottom:1rem; font-size:.9rem; }
  </style>

  
 <h1 class="titulo-modulo w-100 titulo-modulo-con-icono">
   <span class="icono-modulo">S</span>
   Proyectos
 </h1>

  <!-- Buscador -->
  <input type="text" id="searchInput" placeholder="Buscar proyecto…">

  <!-- Formulario -->
  <form method="POST"
        action="{{ url_for('proyectos.edit_proyecto', id=proyecto['id']) if proyecto else url_for('proyectos.new_proyecto') }}">
    <h5>Datos de Proyecto</h5>
    <hr class="line-separator">
    <div class="form-row">
      <div class="form-group col-md-4">
        <label for="proyecto">Proyecto</label>
        <input type="text" name="proyecto" id="proyecto"
               value="{{ proyecto['proyecto'] if proyecto else '' }}"
               class="form-control" required oninput="this.value=this.value.toUpperCase();">
      </div>
      <div class="form-group col-md-4">
        <label for="venta">Venta</label>
        <input type="text" name="venta" id="venta"
               value="{{ proyecto['venta'] if proyecto else '' }}"
               class="form-control" oninput="this.value=this.value.toUpperCase();">
      </div>
      <div class="form-group col-md-4">
        <label for="observacion">Observación</label>
        <input type="text" name="observacion" id="observacion"
               value="{{ proyecto['observacion'] if proyecto else '' }}"
               class="form-control" oninput="this.value=this.value.toUpperCase();">
      </div>
    </div>
    <button type="submit" class="btn btn-primary btn-custom">
      {{ 'Actualizar' if proyecto else 'Crear' }} Proyecto
    </button>
  </form>

  <!-- Tabla de registros -->
  <h5 class="mt-4">Proyectos Registrados</h5>
  <hr class="line-separator">
  <table class="table table-bordered" id="tableBody">
    <thead>
      <tr><th>Proyecto</th><th>Venta</th><th>Observación</th><th>Acciones</th></tr>
    </thead>
    <tbody>
      {% for p in proyectos %}
        <tr>
          <td>{{ p['proyecto'] }}</td>
          <td>{{ p['venta']|clp }}</td>
          <td>{{ p['observacion'] }}</td>
          <td>
            <a href="{{ url_for('proyectos.edit_proyecto', id=p['id']) }}" class="btn btn-warning btn-sm">Editar</a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Script de búsqueda -->
  <script>
    document.getElementById('searchInput').addEventListener('input', function() {
      const term = this.value.toLowerCase();
      document.querySelectorAll('#tableBody tbody tr').forEach(row => {
        row.style.display = row.children[0].textContent.toLowerCase().includes(term) ? '' : 'none';
      });
    });
  </script>
{% endblock %}